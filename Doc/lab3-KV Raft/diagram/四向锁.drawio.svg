<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1231px" height="581px" viewBox="-0.5 -0.5 1231 581" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2023-07-25T01:46:10.323Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&quot; etag=&quot;j4YC0W9QZmOSNAjVEMxi&quot; version=&quot;21.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;第 1 页&quot; id=&quot;7Biunpa2JNx_0wgUib2D&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 0 290 L 1130 290" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><rect x="40" y="450" width="80" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 465px; margin-left: 41px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 24px;"><b style="">Raft层</b></font></div></div></div></foreignObject><text x="80" y="469" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Raft层</text></switch></g><rect x="20" y="140" width="120" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 160px; margin-left: 21px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 24px;"><b style="">应用层</b></font></div></div></div></foreignObject><text x="80" y="164" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">应用层</text></switch></g><rect x="280" y="30" width="240" height="190" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 125px; margin-left: 281px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;"><br /></font></div></div></div></foreignObject><text x="400" y="129" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><path d="M 110.5 129.5 L 110.5 119.5 L 220.5 119.5 L 220.5 109 L 239.5 124.5 L 220.5 140 L 220.5 129.5 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="300" y="55" width="200" height="140" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 125px; margin-left: 301px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 16px;">client通过RPC发来请求，调用kvserver的handle函数（Get / PutAppend），<b>拿到了锁 kv.mu</b>，并调用kv.rf.Start()，<b>等待Start()执行完才会释放锁kv.mu</b></font></div></div></div></foreignObject><text x="400" y="129" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">client通过RPC发来请求，调用kvserver的handle函数（Get / PutA...</text></switch></g><path d="M 394.5 230.5 L 404.5 230.5 L 404.5 350.5 L 415 350.5 L 399.5 369.5 L 384 350.5 L 394.5 350.5 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="280" y="390" width="240" height="190" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 485px; margin-left: 281px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;"><br /></font></div></div></div></foreignObject><text x="400" y="489" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><rect x="300" y="415" width="200" height="140" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 485px; margin-left: 301px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 16px;">rf.Start()内部需要先调用rf.GetState()获取raft peer的状态，但是<b>GetState()内部需要请求锁rf.mu</b>，导致rf.Start()也只能等待</font></div></div></div></foreignObject><text x="400" y="489" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">rf.Start()内部需要先调用rf.GetState()获取raft peer的状态，但是G...</text></switch></g><rect x="210" y="250" width="170" height="130" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 315px; margin-left: 211px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 16px;"><font face="Comic Sans MS">handle等待rf.Start()执行结束才释放kv.mu</font></span></div></div></div></foreignObject><text x="295" y="319" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">handle等待rf.Start()执行结束才释放kv.mu</text></switch></g><path d="M 799.51 120 L 799.49 130 L 579.49 129.54 L 579.47 140.04 L 560.5 124.5 L 579.53 109.04 L 579.51 119.54 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 560.5 485 L 560.5 475 L 780.5 475 L 780.5 464.5 L 799.5 480 L 780.5 495.5 L 780.5 485 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="570" y="350" width="190" height="130" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 188px; height: 1px; padding-top: 415px; margin-left: 571px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 16px;"><font face="Comic Sans MS">rf.GetState()等待rf.applier()将lastApplied到commitIndex之间的日志都apply发送到applyCh后才能请求到rf.mu</font></span></div></div></div></foreignObject><text x="665" y="419" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">rf.GetState()等待rf.applier()将lastAp...</text></switch></g><rect x="830" y="390" width="260" height="190" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 485px; margin-left: 831px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;"><br /></font></div></div></div></foreignObject><text x="960" y="489" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><rect x="851.88" y="407.5" width="218.12" height="162.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 216px; height: 1px; padding-top: 489px; margin-left: 853px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 16px;">rf.applier()<b>先持有锁rf.mu</b>，直到日志apply到commitIndex的位置前都不会释放rf.mu，但是每个日志apply需要将applyMsg发送到applyCh，<b>如果kv.applyMessage()不在另一端取出applyMsg这边就无法发送后续的applyMsg</b></font></div></div></div></foreignObject><text x="961" y="492" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">rf.applier()先持有锁rf.mu，直到日志apply到commitIndex的位置前都不会释放rf....</text></switch></g><path d="M 964.5 369.52 L 954.5 369.48 L 954.93 249.48 L 944.43 249.44 L 960 230.5 L 975.43 249.56 L 964.93 249.52 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="830" y="30" width="260" height="190" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 125px; margin-left: 831px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;"><br /></font></div></div></div></foreignObject><text x="960" y="129" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><rect x="850" y="48.75" width="220" height="152.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 125px; margin-left: 851px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 16px;">kv.applyMessage()在<b>等待请求锁kv.mu</b>，如果请求不到锁，也就无法执行后面在状态机应用拿到命令，也就<b>无法进入下一次循环从applyCh中取出下一个applyMsg</b>。由于applyCh无缓冲，因此rf.applier()就无法继续发送</span></div></div></div></foreignObject><text x="960" y="129" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">kv.applyMessage()在等待请求锁kv.mu，如果请求不到锁，也就无法执行后面在状态机应用拿到命令，也就无法进入下一次循环从applyCh中取出下一个applyMs...</text></switch></g><rect x="970" y="260" width="260" height="140" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 330px; margin-left: 971px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 16px;"><font face="Comic Sans MS">rf.applier()等待kv.applyMessage()从applyCh中取出发送的所有applyMsg才释放rf.mu</font></span></div></div></div></foreignObject><text x="1100" y="334" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">rf.applier()等待kv.applyMessage()从applyCh中取出发送的所有applyMs...</text></switch></g><rect x="590" y="0" width="190" height="130" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 188px; height: 1px; padding-top: 65px; margin-left: 591px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 16px;"><font face="Comic Sans MS">kv.applyMessage()等待handle函数释放kv.mu才能请求到kv.mu，从而继续在状态机执行命令</font></span></div></div></div></foreignObject><text x="685" y="69" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">kv.applyMessage()等待handle函数释放kv.mu才能请求到kv....</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>